已链接应用程序

正在上传和乱码；

# [Confluence](/)

  * [ Event Hub ](/plugins/easyevents/event-hub.action#/eventhub)
  * [ eazyBI ](/plugins/servlet/eazybi)
  * 

  * 帮助

    * [ 在线帮助 ](https://docs.atlassian.com/confluence/docs-614/ "访问Confluence文档首页")
    * 快捷键 
    * [ RSS源建立器 ](/dashboard/configurerssfeed.action "创建个性化的 RSS源。")
    * [ 新功能 ](https://confluence.atlassian.com/display/DOC/Confluence+6.14+Release+Notes)
    * 可用的小工具 
    * [ 关于Confluence ](/aboutconfluencepage.action "获取关于Confluence的更多信息")

  *   *   *   * [ 登录 ](/login.action)

  

## 登录

登录到 Confluence

_U_ 用户名

_P_ 密码

_R_ 记住我的登录信息

[忘记密码](/forgotuserpassword.action)

  * [Čeština](/login.action?language=cs_CZ)
  * [Dansk](/login.action?language=da_DK)
  * [Deutsch](/login.action?language=de_DE)
  * [Eesti](/login.action?language=et_EE)
  * [English (UK)](/login.action?language=en_GB)
  * [English (US)](/login.action?language=en_US)
  * [Español](/login.action?language=es_ES)
  * [Français](/login.action?language=fr_FR)
  * [Íslenska](/login.action?language=is_IS)
  * [Italiano](/login.action?language=it_IT)
  * [Magyar](/login.action?language=hu_HU)
  * [Nederlands](/login.action?language=nl_NL)
  * [Norsk](/login.action?language=no_NO)
  * [Polski](/login.action?language=pl_PL)
  * [Português](/login.action?language=pt_BR)
  * [Română](/login.action?language=ro_RO)
  * [Slovenčina](/login.action?language=sk_SK)
  * [Suomi](/login.action?language=fi_FI)
  * [Svenska](/login.action?language=sv_SE)
  * [Русский](/login.action?language=ru_RU)
  * [日本語](/login.action?language=ja_JP)
  * [中文](/login.action?language=zh_CN)
  * [한국어](/login.action?language=ko_KR)

  * 基于 [Atlassian Confluence](http://www.atlassian.com/software/confluence) 6.14.1 技术构建
  * 由 Atlassian 合流6.14.1 打印
  * [报告缺陷](https://support.atlassian.com/help/confluence)
  * [Atlassian 新闻](http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch)

[Atlassian](http://www.atlassian.com/)

  * 转至内容
  * 转至导航栏
  * 转至主菜单
  * 转至动作菜单
  * 转至快速搜索

已链接应用程序

正在上传和乱码；

# [Confluence](/)

  * [ 空间 ](/spacedirectory/view.action "空间")
  * [ 人员 ](/browsepeople.action "人员")
  * [ Polls ](/polls/listpolls.action "View your polls")
  * [ 日程表 ](/calendar/mycalendar.action "日程表")
  * [ Event Hub ](/plugins/easyevents/event-hub.action#/eventhub)
  * [ eazyBI ](/plugins/servlet/eazybi)
  * [创建](/pages/createpage.action?spaceKey=ARCHITECTURE&fromPageId=15302789&src=quick-create "创建空白页") 创建 

  * 按回车（enter）搜索

  * 帮助

    * [ 在线帮助 ](https://docs.atlassian.com/confluence/docs-614/ "访问Confluence文档首页")
    * 快捷键 
    * [ RSS源建立器 ](/dashboard/configurerssfeed.action "创建个性化的 RSS源。")
    * [ 新功能 ](https://confluence.atlassian.com/display/DOC/Confluence+6.14+Release+Notes?a=false)
    * 可用的小工具 
    * [ 关于Confluence ](/aboutconfluencepage.action "获取关于Confluence的更多信息")

  *   *   *     * [ 个人空间 ](/spaces/viewspace.action?key=~huangxiaocheng)
    * [ 最近浏览 ](/users/viewuserhistory.action)
    * [ 最近的工作 ](/dashboard.action#recently-worked)

    * [ 用户信息 ](/users/viewmyprofile.action)
    * [ 任务 ](/plugins/inlinetasks/mytasks.action)
    * [ Polls ](/polls/listpolls.action)
    * [ 收藏夹 ](/users/viewmyfavourites.action)
    * [ 关注 ](/users/viewnotifications.action)
    * [ 草稿 ](/users/viewmydrafts.action)
    * [ 网络 ](/users/viewfollow.action?username=huangxiaocheng)
    * [ 设置 ](/users/viewmysettings.action)
    * [ Atlassian Marketplace ](/plugins/servlet/upm/requests?source=header_user)

    * [ 注销 ](/logout.action)

  

[![架构部](/images/logo/default-space-
logo.svg)](/pages/viewpage.action?pageId=1081762 "架构部")

[架构部](/pages/viewpage.action?pageId=1081762 "架构部")

  * [页面](/collector/pages.action?key=ARCHITECTURE)
  * [博文](/pages/viewrecentblogposts.action?key=ARCHITECTURE)
  * [日程表](/display/ARCHITECTURE/calendars)

##### 页面树结构

[](/collector/pages.action?key=ARCHITECTURE)

重排页面

设置空间管理

  * [ _E_ 编辑  ](/pages/editpage.action?pageId=15302789 "编辑")
  * _F_ 收藏 
  * __ 观看 
  * _S_ 分享 
  *     * [ _t_ 附件(4)  ](/pages/viewpageattachments.action?pageId=15302789 "查看附件")
    * [ 页面历史  ](/pages/viewpreviousversions.action?pageId=15302789)
    * [ 限制  ](/pages/viewinfo.action?pageId=15302789 "编辑限制")

    * [ 页面信息  ](/pages/viewinfo.action?pageId=15302789)
    * 已解决评论 
    * [ 以层级方式查看  ](/pages/reorderpages.action?key=ARCHITECTURE&openId=15302789#selectedPageInHierarchy)
    * [ 查看页面源代码  ](/plugins/viewsource/viewpagesrc.action?pageId=15302789)
    * [ 导出为PDF  ](/spaces/flyingpdf/pdfpageexport.action?pageId=15302789)
    * [ 导出为Word  ](/exportword?pageId=15302789)
    * [ Doc文件导入  ](/pages/worddav/uploadimport.action?pageId=15302789)

    * [ 复制  ](/pages/copypage.action?idOfPageToCopy=15302789&spaceKey=ARCHITECTURE)
    * [ 移动  ](/pages/viewpage.action?pageId=15302789)

  1. [页面](/collector/pages.action?key=ARCHITECTURE)
  2. **…**
  3. [架构部 主页](/pages/viewpage.action?pageId=1081762)
  4. [技术中心](/pages/viewpage.action?pageId=24580659)
  5. [基础架构](/pages/viewpage.action?pageId=1081770)
  6. [电商](/pages/viewpage.action?pageId=6849773)
  7. [业务网关](/pages/viewpage.action?pageId=59609788) 

跳到banner的尾部

  * []( "权限限制")[](/pages/viewpageattachments.action?pageId=15302789&metadataLink=true "4 个附件")
  * [JIRA 链接]()

回到标题开始

#  [商城业务网关](/pages/viewpage.action?pageId=15302789)

转至元数据结尾

  * 由 [蔡础栋](    /display/~caichudong
)创建, 最后修改于[八月 06,
2020](/pages/diffpagesbyversion.action?pageId=15302789&selectedPageVersions=27&selectedPageVersions=28
"查看变更")

转至元数据起始

###

背景

商城服务化的发展，前后端分离、分布式服务对于登录态和各个接入方的管理需要统一，避免对业务的入侵、解决认证等问题，因此在网关层完成一整套处理。

### 地址

<http://bbc-giant.dev.ym> 开发环境

<https://t-mall-gw.carrieym.com> 测试环境

<https://p-mall-gw.carrieym.com> 预发布环境

<https://mall-gw.carrieym.com> 生产环境

  

### 申请appid，secret模板

发邮件申请对应信息。

发送给
[c](mailto:caichudong@ecpark.cn)[aichudong@ecpark.cn](mailto:aichudong@ecpark.cn);
[liyunlang@ecpark.cn](mailto:liyunlang@ecpark.cn)

抄送给 对应上级

邮件正文写明 哪个业务线申请访问电商网关appid，secret

### 网关请求标准

协议：https

方式：post

数据格式：x-www-form-urlencoded

### 网关请求参数

![](/download/attachments/15302789/801B91C8-2526-4382-8512-20731376B36B.png?version=1&modificationDate=1593743473000&api=v2)

[【bbc聚合服务】接口服务](http://wiki.ym/pages/viewpage.action?pageId=36209259)

###  网关服务

###
![](/download/attachments/15302789/%E7%BD%91%E5%85%B3.jpg?version=2&modificationDate=1573107023000&api=v2)

  

第一版正式运行，承接了业务的应用认证和sign认证。

  

### 说明

基于openresty(nginx)开发，可以无侵入式接管应用与服务，目前运维层的nginx都是openresty包，无需做任何升级。

  

### gw-token客户端组件

[电商侧网关 api token 鉴权方案设计](/pages/viewpage.action?pageId=15308085)

### apollo客户端组件

[电商侧网关 apollo方案设计](/pages/viewpage.action?pageId=18743666)

### 服务响应码规范

[服务响应码规范](http://wiki.ym/pages/viewpage.action?pageId=15311640)

### 签名

[签名算法](http://wiki.ym/pages/viewpage.action?pageId=29953313)

  

### 注意事项

1.网关设计用于api请求（短频快），不应该有过大的请求正文，比如上传大文件资源就不应该请求网关服务，过大的请求建议拆分为多个子请求

2.不建议请求正文中存在多维数组/map

3.后台功能请保证路由参数以admin为开头

  

  * 无标签 
  * 编辑标签

[![用户图标:
添加头像](/s/zh_CN/7901/70b99a3474165a6093a2423f21069b9c63f07abc/_/images/icons/profilepics/add_profile_pic.svg)](/users/profile/editmyprofilepicture.action
"添加头像")

编写评论...

[添加评论](/pages/viewpage.action?pageId=15302789&showComments=true&showCommentArea=true#addcomment)

概览

内容工具

活动

  * 基于 [Atlassian Confluence](http://www.atlassian.com/software/confluence) 6.14.1 技术构建
  * 由 Atlassian 合流6.14.1 打印
  * [报告缺陷](https://support.atlassian.com/help/confluence)
  * [Atlassian 新闻](http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch)

[Atlassian](http://www.atlassian.com/)

{"serverDuration": 189, "requestCorrelationId": "49c75d85f5877443"}

